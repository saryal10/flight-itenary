<!DOCTYPE html>
<html>
<head>
    <title>Flight Itinerary Generator</title>
    <style>
        body { font-family: sans-serif; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="text"], input[type="date"], input[type="number"] { width: 300px; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { background-color: #007bff; color: white; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background-color: #0056b3; }
        #connectingFlights { margin-top: 20px; }
        .connecting-flight-form { border: 1px solid #eee; padding: 15px; margin-bottom: 10px; border-radius: 5px; }
        .remove-flight-button { background-color: #dc3545; color: white; padding: 8px 12px; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; margin-top: 10px; }
        .remove-flight-button:hover { background-color: #c82333; }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        let connectingFlightCount = 0;

        function addConnectingFlight() {
            connectingFlightCount++;
            const connectingFlightsDiv = document.getElementById('connectingFlights');
            const flightForm = document.createElement('div');
            flightForm.classList.add('connecting-flight-form');
            flightForm.innerHTML = `
                <h3>Connecting Flight ${connectingFlightCount}</h3>
                <div class="form-group">
                    <label for="departureCity${connectingFlightCount}">Departure City:</label>
                    <input type="text" id="departureCity${connectingFlightCount}" name="departureCity${connectingFlightCount}">
                </div>
                <div class="form-group">
                    <label for="arrivalCity${connectingFlightCount}">Arrival City:</label>
                    <input type="text" id="arrivalCity${connectingFlightCount}" name="arrivalCity${connectingFlightCount}">
                </div>
                <div class="form-group">
                    <label for="departureDate${connectingFlightCount}">Departure Date:</label>
                    <input type="date" id="departureDate${connectingFlightCount}" name="departureDate${connectingFlightCount}">
                </div>
                <div class="form-group">
                    <label for="departureTime${connectingFlightCount}">Departure Time (e.g., 14:30):</label>
                    <input type="text" id="departureTime${connectingFlightCount}" name="departureTime${connectingFlightCount}" placeholder="HH:MM">
                </div>
                <div class="form-group">
                    <label for="airline${connectingFlightCount}">Airline:</label>
                    <input type="text" id="airline${connectingFlightCount}" name="airline${connectingFlightCount}">
                </div>
                <div class="form-group">
                    <label for="flightNumber${connectingFlightCount}">Flight Number:</label>
                    <input type="text" id="flightNumber${connectingFlightCount}" name="flightNumber${connectingFlightCount}">
                </div>
                <button type="button" class="remove-flight-button" onclick="removeConnectingFlight(this)">Remove Flight</button>
            `;
            connectingFlightsDiv.appendChild(flightForm);
        }

        function removeConnectingFlight(button) {
            const flightForm = button.parentNode;
            flightForm.remove();
            // You might want to re-index the connecting flight numbers if needed for display
        }

        function generateItinerary() {
            const mainFormData = new FormData(document.getElementById('mainFlightForm'));
            const mainFlightData = {};
            mainFormData.forEach((value, key) => mainFlightData[key] = value);

            const connectingFlightsData = [];
            const connectingFlightForms = document.querySelectorAll('#connectingFlights .connecting-flight-form');
            connectingFlightForms.forEach(form => {
                const formData = new FormData(form);
                const flightData = {};
                formData.forEach((value, key) => flightData[key.replace(/\d+$/, '')] = value); // Remove the number suffix from keys
                connectingFlightsData.push(flightData);
            });

            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF();

            const pageWidth = pdf.internal.pageSize.getWidth();
            const margin = 15;
            let y = margin + 10;
            const lineHeight = 7;

            // --- Header ---
            pdf.setFontSize(18);
            pdf.setFont('helvetica', 'bold');
            pdf.text("FLIGHT ITINERARY", margin, y);
            y += lineHeight + 8;
            pdf.line(margin, y - 2, pageWidth - margin, y - 2);

            // --- Passenger Information ---
            pdf.setFontSize(12);
            pdf.setFont('helvetica', 'normal');
            pdf.text(`Passenger: ${mainFlightData.passengerName}`, margin, y);
            y += lineHeight;
            pdf.text(`Booking Reference: ${mainFlightData.bookingReference}`, margin, y);
            y += lineHeight + 5;

            // --- Main Flight Details ---
            pdf.setFontSize(14);
            pdf.setFont('helvetica', 'bold');
            pdf.text("Main Flight:", margin, y);
            y += lineHeight;
            pdf.setFontSize(12);
            pdf.setFont('helvetica', 'normal');
            y = addFlightDetailsToPDF(pdf, mainFlightData, margin + 5, y, lineHeight);
            y += 10;

            // --- Connecting Flights ---
            if (connectingFlightsData.length > 0) {
                pdf.setFontSize(14);
                pdf.setFont('helvetica', 'bold');
                pdf.text("Connecting Flights:", margin, y);
                y += lineHeight;
                pdf.setFontSize(12);
                pdf.setFont('helvetica', 'normal');
                for (let i = 0; i < connectingFlightsData.length; i++) {
                    const flight = connectingFlightsData[i];
                    pdf.setFont('helvetica', 'bold');
                    pdf.text(`Connecting Flight ${i + 1}:`, margin + 5, y);
                    y += lineHeight;
                    pdf.setFont('helvetica', 'normal');
                    y = addFlightDetailsToPDF(pdf, flight, margin + 10, y, lineHeight);
                    y += 8;
                }
            }

            // --- Important Notes ---
            pdf.setFontSize(10);
            pdf.setFont('helvetica', 'italic');
            const notes = "Please arrive at the airport at least 2 hours prior to the scheduled departure time. Check the airline's website for any updates or changes to your flight schedule.";
            const notesLines = pdf.splitTextToSize(notes, pageWidth - 2 * margin);
            y += 10;
            pdf.text("Important Notes:", margin, y);
            y += lineHeight;
            notesLines.forEach(line => {
                pdf.text(line, margin, y);
                y += lineHeight - 1;
            });

            pdf.save('flight_itinerary.pdf');
        }

        function addFlightDetailsToPDF(pdf, flightData, x, y, lineHeight) {
            pdf.text(`From: ${flightData.departureCity ? flightData.departureCity.toUpperCase() : 'N/A'}`, x, y);
            y += lineHeight;
            pdf.text(`To: ${flightData.arrivalCity ? flightData.arrivalCity.toUpperCase() : 'N/A'}`, x, y);
            y += lineHeight;
            pdf.text(`Date: ${flightData.departureDate || 'N/A'} ${flightData.departureTime || ''}`, x, y);
            y += lineHeight;
            pdf.text(`Airline: ${flightData.airline || 'N/A'} - Flight: ${flightData.flightNumber ? flightData.flightNumber.toUpperCase() : 'N/A'}`, x, y);
            return y + 5;
        }
    </script>
</head>
<body>
    <h1>Generate Your Flight Itinerary</h1>
    <form id="mainFlightForm">
        <h2>Main Flight</h2>
        <div class="form-group">
            <label for="passengerName">Passenger Name:</label>
            <input type="text" id="passengerName" name="passengerName" required>
        </div>
        <div class="form-group">
            <label for="departureCity">Departure City:</label>
            <input type="text" id="departureCity" name="departureCity" required>
        </div>
        <div class="form-group">
            <label for="arrivalCity">Arrival City:</label>
            <input type="text" id="arrivalCity" name="arrivalCity" required>
        </div>
        <div class="form-group">
            <label for="departureDate">Departure Date:</label>
            <input type="date" id="departureDate" name="departureDate" required>
        </div>
        <div class="form-group">
            <label for="departureTime">Departure Time (e.g., 14:30):</label>
            <input type="text" id="departureTime" name="departureTime" placeholder="HH:MM">
        </div>
        <div class="form-group">
            <label for="airline">Airline:</label>
            <input type="text" id="airline" name="airline">
        </div>
        <div class="form-group">
            <label for="flightNumber">Flight Number:</label>
            <input type="text" id="flightNumber" name="flightNumber">
        </div>
        <div class="form-group">
            <label for="bookingReference">Booking Reference:</label>
            <input type="text" id="bookingReference" name="bookingReference">
        </div>
    </form>

    <div id="connectingFlights">
        <h2>Connecting Flights</h2>
    </div>

    <button type="button" onclick="addConnectingFlight()">Add Connecting Flight</button>
    <button type="button" onclick="generateItinerary()">Generate Flight Itinerary</button>
</body>
</html>
